<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Model Load – PnP-XAI-LLM</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />
  </head>
  <body>
    <nav class="tab-bar" aria-label="Page navigation">
      <div class="tab-bar-tabs">
        <a href="/" class="tab-link {{ 'active' if active_tab == 'main' else '' }}">Main</a>
        <a href="/model_load" class="tab-link {{ 'active' if active_tab == 'model_load' else '' }}">Model Load</a>
        <a href="/src_destination" class="tab-link {{ 'active' if active_tab == 'src_destination' else '' }}">SRC / Destination</a>
        <a href="/circuit_panel" class="tab-link {{ 'active' if active_tab == 'circuit_panel' else '' }}">Circuit</a>
        <a href="/computation_test" class="tab-link {{ 'active' if active_tab == 'computation_test' else '' }}">Computation Test</a>
      </div>
      <div class="tab-bar-actions">
        <span class="tab-bar-loaded">Loaded: <span id="global-loaded-model">—</span></span>
        <div class="toolbar-group">
          <span class="toolbar-label">Model</span>
          <select id="model" class="toolbar-select">
            {% for m in models %}
            <option value="{{ m }}">{{ m }}</option>
            {% endfor %}
          </select>
          <button type="button" id="load-model" class="toolbar-button">Load</button>
        </div>
      </div>
    </nav>
    <header>
      <div class="header-top">
        <div class="toolbar-group">
          <span class="toolbar-label">CUDA_VISIBLE_DEVICES</span>
          <input
            type="text"
            id="cuda-devices"
            class="toolbar-cuda-input"
            value="0"
            placeholder="0,1,2"
            autocomplete="off"
          />
          <button type="button" id="cuda-export-btn" class="toolbar-button">Export</button>
        </div>
      </div>
      <div class="header-bottom">
        <h1>Model Load</h1>
      </div>
    </header>
    <main class="main-model-load">
      <section class="card card-with-chat">
        <div class="status">
          <span class="dot"></span>
          Model Load
        </div>
        <p class="muted">Select a model above and click Load. Loaded model is used globally across all tabs.</p>
        <div id="model-status" class="chat-status" style="margin-top:12px;"></div>
        <div id="conversation-wrap" class="chat-wrap" style="display:none;">
          <div id="conversation-log" class="chat-log" aria-live="polite"></div>
          <div class="chat-input-row">
            <input
              id="conversation-input"
              type="text"
              placeholder="Message..."
              autocomplete="off"
            />
            <button type="button" id="conversation-send" class="chat-send">Send</button>
            <button type="button" id="conversation-clear-cache" class="chat-send chat-clear-cache">Clear cache</button>
          </div>
        </div>
        <div id="conversation-placeholder" class="chat-help">
          Load a model above to start conversation.
        </div>
      </section>
      <section class="card model-status-card">
        <div class="status">
          <span class="dot"></span>
          Loaded model status
        </div>
        <div id="model-status-placeholder" class="model-status-placeholder">
          Load를 실행하면 여기에 상태가 표시됩니다.
        </div>
        <div id="model-status-body" class="model-status-body" hidden>
          <table class="model-status-table">
            <tr><th>Name</th><td id="status-name"></td></tr>
            <tr><th>Number of layers</th><td id="status-layers"></td></tr>
            <tr><th>Number of heads</th><td id="status-heads"></td></tr>
            <tr><th>Parameters</th><td id="status-params"></td></tr>
            <tr><th>Device status</th><td id="status-devices"></td></tr>
            <tr><th>Cache tokens</th><td id="status-cache-tokens">—</td></tr>
          </table>
        </div>
        <div id="model-status-error" class="model-status-error" hidden></div>
      </section>
    </main>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
  </body>
</html>
